name: CI

on: [push]

jobs:
    sast_scan:
      name: Run brakeman scan
      # Run this job on ubuntu-latest
      runs-on: ubuntu-latest
  
      steps:
        - name: Checkout Repo
          uses: actions/checkout@v2
        
        - name: Setup Ruby
          uses: ruby/setup-ruby@v1
          with:
            bundler-cache: true
  
        - name: Run brakeman
          run: | 
            brakeman -o .github/brakeman.log
            cat .github/brakeman.log
            if grep -q "No warnings found" .github/brakeman.log; then
              echo '{"status": "success"}' > brakeman_status.json
            else
              echo '{"status": "failure"}' > brakeman_status.json
            fi